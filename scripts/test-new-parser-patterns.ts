/**
 * Test script for new parser patterns (November 5, 2025)
 * Tests:
 * 1. Direct amount format "ê¸ˆì•¡ : 45,000,000ì›"
 * 2. Applicant qualification extraction
 */

import { extractBudget, extractEligibilityCriteria } from '../lib/scraping/parsers/ntis-announcement-parser';

console.log('ğŸ§ª Testing New Parser Patterns (November 5, 2025)\n');
console.log('â•'.repeat(70));

// ============================================================================
// TEST 1: Direct Amount Format (from screenshot 4)
// ============================================================================
console.log('\nğŸ“ TEST 1: Direct Amount Format');
console.log('â”€'.repeat(70));

const testText1 = `
ìš©ì—­ì…ì°° ê³µê³ 
ê³„ ì•½ ë°© ë²• : ì œí•œê²½ìŸ
ì… ì°° ë°© ë²• : ì „ìì— ì˜í•œ ê³„ì•½
ìš© ì—­ ê±´ ëª… : ìƒˆë¡œìš´ í™˜ê²½ë³€í™”ì— ëŒ€ì‘í•˜ê¸° ìœ„í•œ í•´ì™¸ì„¼í„° íš¨ìœ¨í™” ë°©ì•ˆ ì—°êµ¬
ê°œ ê³µ ì¼ ì‹œ : ì œì•ˆì„œ ê¸°ìˆ ëŠ¥ë ¥í‰ê°€ í›„
ë‚© í’ˆ ê¸° í•œ : ê³„ì•½ ì²´ê²° í›„ 120ì¼
ê¸ˆ ì•¡ : 45,000,000ì›(ë¶€ê°€ê°€ì¹˜ì„¸ í¬í•¨)[ì¶”ì •ê°€ê²©: 40,909,091ì›]
ì… ì°° ë°© ì‹ : ì „ìì…ì°°
`;

const budget1 = extractBudget(testText1);
console.log(`Input text snippet: "ê¸ˆ ì•¡ : 45,000,000ì›(ë¶€ê°€ê°€ì¹˜ì„¸ í¬í•¨)"`);
console.log(`Expected budget: 45,000,000`);
console.log(`Extracted budget: ${budget1?.toLocaleString() || 'NULL'}`);
console.log(`âœ… PASS: ${budget1 === 45000000 ? 'CORRECT' : 'FAILED'}`);

// ============================================================================
// TEST 2: Applicant Qualifications (from screenshot 3-4)
// ============================================================================
console.log('\nğŸ“ TEST 2: Applicant Qualifications');
console.log('â”€'.repeat(70));

const testText2 = `
< ë³¸ ê³„ì•½ì€ ì²­ë ´ê³„ì•½(ì„œì•½)ì œê°€ ì ìš©ë©ë‹ˆë‹¤ >

ë³¸ ê³„ì•½ì€ ã€Œêµ­ê°€ë¥¼ ë‹¹ì‚¬ìë¡œ í•˜ëŠ” ê³„ì•½ì— ê´€í•œ ë²•ë¥ ã€ì— ë”°ë¥¸ ì²­ë ´ê³„ì•½ì œê°€ ì ìš©ë©
ë‹ˆë‹¤. ì…ì°°ìëŠ” ë°˜ë“œì‹œ ì…ì°°ì„œ ì œì¶œì‹œ ì•„ë˜ì˜ ì²­ë ´ê³„ì•½ì„œì— ê´€í•œ ë‚´ìš©ì„ ìˆ™ì§€Â·
ìˆ™ë…í•˜ì—¬ì•¼ í•˜ë©°, ë™ ë‚´ìš©ì„ ìœ„ë°˜í•œ ê²½ìš° ë°œì£¼ê¸°ê´€ì˜ ì¡°ì¹˜ì— ëŒ€í•˜ì—¬ ì–´ë– í•œ ì´ì˜ë„
ì œê¸°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

1. ê¸ˆí’ˆÂ·í–¥ì‘ ë“±(ì¹œì¸ì²™ ë“±ì— ëŒ€í•œ ë¶€ì •í•œ ì·¨ì—… ì œê³µ í¬í•¨)ì„ ìš”êµ¬ ë˜ëŠ” ì•½ì†Â·
   í•˜ê±°ë‚˜ ìˆ˜ìˆ˜(æˆå—)í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

2. ì…ì°°ê°€ê²©ì˜ ì‚¬ì „ í˜‘ì˜ ë˜ëŠ” íŠ¹ì •ì¸ì˜ ë‚™ì°°ì„ ìœ„í•œ ë‹´í•© ë“± ê³µì •í•œ ê²½ìŸì„
   ë°©í•´í•˜ëŠ” í–‰ìœ„ë¥¼ í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

3. ê³µì •í•œ ì§ë¬´ìˆ˜í–‰ì„ ë°©í•´í•˜ëŠ” ì•Œì„ Â·ì²­íƒì„ í†µí•˜ì—¬ ì…ì°° ë˜ëŠ” ê³„ì•½ê³¼ ê´€ë ¨ëœ
   íŠ¹ì • ì •ë³´ì˜ ì œê³µì„ ìš”êµ¬í•˜ê±°ë‚˜ ë°›ëŠ” í–‰ìœ„ë¥¼ í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

4. ã€Œêµ­ê°€ë¥¼ ë‹¹ì‚¬ìë¡œ í•˜ëŠ” ê³„ì•½ì— ê´€í•œ ë²•ë¥  ì‹œí–‰ë ¹ã€ì œ4ì¡°ì˜2 ì œ1í•­ ì œ2í˜¸
   ìœ„ë°˜ ì‹œì— ì•„ë˜ì˜ ì†í•´ë°°ìƒì•¡ì„ ë‚©ë¶€í† ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
   - ì…ì°°ì : ì…ì°°ê¸ˆì•¡ì˜ 100ë¶„ì˜ 5
   - ê³„ì•½ìƒëŒ€ì : ê³„ì•½ê¸ˆì•¡ì˜ 100ë¶„ì˜ 10

ã€Œêµ­ê°€ë¥¼ ë‹¹ì‚¬ìë¡œ í•˜ëŠ” ê³„ì•½ì— ê´€í•œ ë²•ë¥ ã€ì œ5ì¡°ì˜2 ì œ2ì— ë”°ë¼ ë³¸ ì…ì°°ì— ì°¸ì—¬í•œ
ë‹¹ì‚¬ ëŒ€ë¦¬ì¸ê³¼ ì„ì§ì›ì€ ì…ì°°Â·ë‚™ì°°, ê³„ì•½ì²´ê²° ë˜ëŠ” ê³„ì•½ì´í–‰ ë“±ì˜ ê³¼ì •(ì¤€
ê³µÂ·ë‚©í’ˆ ì´í›„ë¥¼ í¬í•¨í•œë‹¤)ì—ì„œ ì•„ë˜ ê° í˜¸ì˜ ì²­ë ´ì˜ë¬´ ì¡°ê±´ì„ ì¤€ìˆ˜í•  ê²ƒì´ë©°,
ì´ë¥¼ ìœ„ë°˜í•  ë•Œì—ëŠ” ì…ì°°ë‚™ì°°ì„ ì·¨ì†Œí•˜ê±°ë‚˜ ê³„ì•½ì„ í•´ì œÂ·í•´ì§€í•˜ëŠ” ë“±ì˜ ë¶ˆì´ìµ
ì„ ê°ìˆ˜í•˜ê³ , ì´ì— ë¯¼Â·í˜•ì‚¬ìƒ ì´ì˜ë¥¼ ì œê¸°í•˜ì§€ ì•Šì„ ê²ƒì„ì„ ì•½ì •í•©ë‹ˆë‹¤.

ë‚˜. í•˜ë„ê¸‰ì€ ë¶ˆê°€í•©ë‹ˆë‹¤.

1. ì…ì°°ì— ë¶€ì¹˜ëŠ” ì‚¬í•­
   ê³„ ì•½ ë°© ë²• : ì œí•œê²½ìŸ
   ì… ì°° ë°© ë²• : ì „ìì— ì˜í•œ ê³„ì•½
   ìš© ì—­ ê±´ ëª… : ìƒˆë¡œìš´ í™˜ê²½ë³€í™”ì— ëŒ€ì‘í•˜ê¸° ìœ„í•œ í•´ì™¸ì„¼í„° íš¨ìœ¨í™” ë°©ì•ˆ ì—°êµ¬
   ê°œ ê³µ ì¼ ì‹œ : ì œì•ˆì„œ ê¸°ìˆ ëŠ¥ë ¥í‰ê°€ í›„
   ë‚© í’ˆ ê¸° í•œ : ê³„ì•½ ì²´ê²° í›„ 120ì¼
   ê¸ˆ ì•¡ : 45,000,000ì›(ë¶€ê°€ê°€ì¹˜ì„¸ í¬í•¨)[ì¶”ì •ê°€ê²©: 40,909,091ì›]
   ì… ì°° ë°© ì‹ : ì „ìì…ì°°

2. ì…ì°°ì°¸ê°€ìê²©
   ê°€. ì•„ë˜ì˜ ìê²©ì„ ëª¨ë‘ ê°–ì¶˜ ìì´ì–´ì•¼ í•©ë‹ˆë‹¤.
   â—‹ ã€Œêµ­ê°€ì¢…í•©ì „ìì¡°ë‹¬ì‹œìŠ¤í…œ ì…ì°°ì°¸ê°€ìê²©ë“±ë¡[êµ­ê°€ì¢…í•©ì „ìì¡°ë‹¬ì‹œìŠ¤í…œ 1169]ì†Œë¡œ ì…ì°°
     ì°¸ê°€ìê²©ì´ ë“±ë¡ë˜ì–´ ìˆê±°ë‚˜ ë˜ëŠ” í•™ìˆ Â·ì—°êµ¬ìš©ì—­ã€ì— ì˜í•˜ì—¬ ë°˜ë“œì‹œ ë‚˜ë¼ì¥í„°
     (G2B)ì— ì…ì°°ì„œ ì œì¶œì‹œ ì´ c2dì—´ê³¼ ì…ì°°ì„œ ì œì¶œì‹œ ì „ì„¤ë¬¸ì„ ì²¨ë¶€í•˜ì—¬ì•¼ í•¨

   â—‹ ã€Œì¤‘ì†Œê¸°ì—…ë²•ã€ì‹œí–‰ë ¹, ì œ8ì¡°ì— ë”°ë¥¸ ì†Œê¸°ì—…(ã€Œì†Œìƒê³µì¸ ë³´í˜¸ ë° ì§€ì›ì—
     ê´€í•œ ë²•ë¥ ã€ì œ2ì¡°ì— ë”°ë¥¸ ì†Œìƒê³µì¸ í¬í•¨)ìœ¼ë¡œì„œ ã€Œì¤‘ì†Œê¸°ì—… ë²•ì¸ ë° í™•ì¸ì—
     ê´€í•œ ê·œì •ã€ì— ë”°ë¼ ë°›ì¦ëœ ã€Œì†Œìƒê³µì¸ ë³´í˜¸ ë° ì§€ì›ì— ê´€í•œ ë²•ë¥ ã€ì œ8ì¡°ì—
     ì˜ê±° ë°œê¸‰ëœ í™•ì¸ì„œë¥¼ ì…ì°° ì œì¶œì‹œ ì²¨ë¶€í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.

   ë‚˜. ã€Œêµ­ê°€ë¥¼ ë‹¹ì‚¬ìë¡œ í•˜ëŠ” ê³„ì•½ì— ê´€í•œ ë²•ë¥ ã€ì œ27ì¡°ì˜5 ë° ê°™ì€ ë²• ì‹œí–‰ë ¹
       ì œ76ì¡°ì˜2, ì œ3í•­ì— ë”°ë¼ ì¡°ë‹¬ì„ í•œ ìë£Œë¡œ ì‹œì‘ì„œ ì œì¶œì„ ê°„ì£¼í•©ë‹ˆë‹¤.
`;

const eligibility = extractEligibilityCriteria(testText2);

console.log('\nExtracted Eligibility Criteria:');
console.log(JSON.stringify(eligibility, null, 2));

console.log('\nâœ… Verification:');
console.log(`  - Contains certification "êµ­ê°€ì¢…í•©ì „ìì¡°ë‹¬ì‹œìŠ¤í…œ": ${
  eligibility?.certificationRequirements?.required?.includes('êµ­ê°€ì¢…í•©ì „ìì¡°ë‹¬ì‹œìŠ¤í…œ') ? 'YES âœ“' : 'NO âœ—'
}`);
console.log(`  - Contains certification "í•™ìˆ ì—°êµ¬ìš©ì—­": ${
  eligibility?.certificationRequirements?.required?.some(c => c.includes('í•™ìˆ ')) ? 'YES âœ“' : 'NO âœ—'
}`);
console.log(`  - Contains document "ì¤‘ì†Œê¸°ì—…í™•ì¸ì„œ": ${
  eligibility?.certificationRequirements?.documents?.includes('ì¤‘ì†Œê¸°ì—…í™•ì¸ì„œ') ? 'YES âœ“' : 'NO âœ—'
}`);
console.log(`  - Contains exclusion "ê¸ˆí’ˆí–¥ì‘": ${
  eligibility?.governmentRelationship?.exclusions?.some(e => e.includes('ê¸ˆí’ˆ')) ? 'YES âœ“' : 'NO âœ—'
}`);
console.log(`  - Contains SME requirement: ${
  eligibility?.smeEligible ? 'YES âœ“' : 'NO âœ—'
}`);

// ============================================================================
// SUMMARY
// ============================================================================
console.log('\n' + 'â•'.repeat(70));
console.log('ğŸ“Š TEST SUMMARY');
console.log('â•'.repeat(70));

const test1Pass = budget1 === 45000000;
const test2Pass =
  eligibility?.certificationRequirements?.required?.includes('êµ­ê°€ì¢…í•©ì „ìì¡°ë‹¬ì‹œìŠ¤í…œ') &&
  eligibility?.certificationRequirements?.documents?.includes('ì¤‘ì†Œê¸°ì—…í™•ì¸ì„œ') &&
  eligibility?.governmentRelationship?.exclusions?.some(e => e.includes('ê¸ˆí’ˆ'));

console.log(`Test 1 (Direct Amount): ${test1Pass ? 'âœ… PASS' : 'âŒ FAIL'}`);
console.log(`Test 2 (Qualifications): ${test2Pass ? 'âœ… PASS' : 'âŒ FAIL'}`);
console.log(`\nOverall: ${test1Pass && test2Pass ? 'âœ… ALL TESTS PASSED' : 'âŒ SOME TESTS FAILED'}`);
